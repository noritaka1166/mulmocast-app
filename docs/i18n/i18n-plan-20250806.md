# MulmoCast App i18n Implementation Plan (Updated Post-Main Merge)

**Date**: 2025-08-06  
**Planner**: Claude Code  
**Target**: Complete i18n implementation for remaining 28 components (38% coverage gap)  
**Branch**: i18n-250729  
**Context**: Post main branch merge with NEW priority components

---

## 📊 Executive Summary

Following the comprehensive audit (August 6, 2025), this updated implementation plan addresses the current state of 62% i18n coverage and focuses on completing the remaining 38% with special emphasis on newly introduced components from the main branch merge.

### Current State Analysis
| Metric | Current | Target | Gap |
|--------|---------|--------|-----|
| **Total Components** | 73 | 73 | 0 |
| **i18n Ready Components** | 45 (62%) | 73 (100%) | 28 |
| **Translation Keys** | 414+ | ~450 | ~36 new keys |
| **Critical Issues** | 3 HIGH, 8 MEDIUM | 0 | 11 components |

---

## 🚨 Critical Findings & Priority Matrix

### **HIGH PRIORITY (CRITICAL - NEW from main merge)**
These components were introduced in recent main merge and lack any i18n implementation:

#### 1. `new_project_dialog.vue` ⭐ **URGENT**
- **Impact**: Core user workflow (project creation)
- **Hardcoded Strings**: 
  - `"Create New Project"` (title)
  - `"Enter project title"` (placeholder)
  - `"Cancel"` (button)
  - `"Creating..."` / `"Create"` (dynamic button)
- **Estimated Effort**: 30 minutes
- **Dependencies**: None

#### 2. `text_editor.vue` ⭐ **URGENT**
- **Impact**: New beat editing functionality
- **Hardcoded Strings**:
  - `"Select a speaker"` (placeholder)
  - `"e.g. What is AI?"` (placeholder)
- **Existing i18n**: Already has some i18n but missing key placeholders
- **Estimated Effort**: 20 minutes
- **Dependencies**: None

### **MEDIUM PRIORITY (Partial i18n gaps)**

#### 3. Parameter Components (4 components)
- **`image_params.vue`**: Technical placeholders hardcoded
- **`caption_params.vue`**: CSS examples not internationalized
- **`text_slide_params.vue`**: Technical examples hardcoded
- **Estimated Effort**: 15 minutes each = 60 minutes total

#### 4. Core UI Components (2 components)
- **`header.vue`**: Status text hardcoded
- **`chat.vue`**: Example message hardcoded
- **Estimated Effort**: 20 minutes each = 40 minutes total

---

## ⚠️ **CRITICAL UPDATE: Refactor Required**

### **Current vs Target i18n Structure Analysis**

#### **Current Structure** (Actual en.ts/ja.ts):
```typescript
├── ui/                    ✅ EXISTS (partial)
│   ├── common/           ✅ Implemented
│   ├── actions/          ✅ Implemented  
│   └── status/           ✅ Implemented
├── project/              ✅ EXISTS (current approach)
│   ├── scriptEditor/     ✅ Has movieParams, speechParams
│   └── productTabs/      ✅ Complete structure
├── beat/                 ⚠️ **NEEDS REFACTOR**
│   ├── form/            ❌ Should be beat.textSlide/, beat.markdown/
│   └── (flat structure) ❌ Not following refactor plan schema
└── parameters/          ❌ **MISSING ENTIRELY**
    ├── imageParams/     ❌ Currently in project.scriptEditor.movieParams
    └── audioParams/     ❌ Needs to be extracted and restructured
```

#### **Target Structure** (Refactor Plan Goal):
```typescript
├── ui/           ✅ GOOD
│   ├── common/   ✅ GOOD
│   ├── actions/  ✅ GOOD
│   ├── status/   ✅ GOOD
│   ├── elements/ ❌ MISSING (ui elements: button, input, textarea, etc.)
│   ├── tabs/     ❌ MISSING (text, yaml, json, media, style, ref)
│   └── validation/ ❌ MISSING (required, invalid, tooShort, etc.)
├── beat/         ❌ **NEEDS COMPLETE RESTRUCTURE**
│   ├── textSlide/    ❌ Currently: beat.form.textSlide → Should be: beat.textSlide
│   ├── markdown/     ❌ Currently: beat.form.markdown → Should be: beat.markdown  
│   ├── imagePrompt/  ❌ Currently: beat.form.imagePrompt → Should be: beat.imagePrompt
│   └── [...other beat types]
└── parameters/   ❌ **NEEDS COMPLETE IMPLEMENTATION**
    ├── imageParams/  ❌ Extract from project.scriptEditor.movieParams
    ├── audioParams/  ❌ Extract from project.scriptEditor.speechParams
    └── [...other param types]
```

### **Refactor Requirements Summary**

#### **Major Structural Changes Needed:**
1. **beat.* restructure**: `beat.form.textSlide` → `beat.textSlide` (affects ~15 keys)
2. **parameters.* creation**: Extract from `project.scriptEditor.*` → new `parameters.*` (affects ~25 keys)  
3. **ui.elements/tabs/validation**: Add missing UI categories (~20 new keys)
4. **Component updates**: Update ALL components using old key paths (~30 files)

#### **Effort Estimate Revision:**
- **Original estimate**: 3 days, 5 hours (minor additions only)
- **Actual requirement**: 5-7 days, 12-15 hours (major refactor + additions)

## 🎯 **Revised Implementation Strategy**

### **Phase-Based Approach (Refactor + Implementation)**

#### **Phase A: Structure Refactor (Days 1-2, 4-5 hours)**
**Objective**: Align current i18n structure with refactor plan target

| Task | Effort | Description |
|------|--------|-------------|
| Restructure beat.* keys | 90min | Move beat.form.* → beat.[type].* |
| Create parameters.* structure | 90min | Extract from project.scriptEditor.* |
| Add missing ui.* categories | 60min | elements, tabs, validation |
| Update affected components | 90min | Fix all component key references |

**Phase A Total**: 5 hours

#### **Phase B: New Component Implementation (Day 3, 1.5 hours)**
**Objective**: Fix critical user-facing components introduced by main merge

| Component | Priority | Effort | Status | Rationale |
|-----------|----------|--------|--------|-----------|
| `new_project_dialog.vue` | 🔴 Critical | 30min | ❌ NEW | Core project creation flow |
| `text_editor.vue` | 🔴 Critical | 20min | ❌ NEW | New beat editing component |
| `chat.vue` (placeholder fix) | 🟡 Medium | 10min | ⚠️ Partial | Example text hardcoded |
| `header.vue` (status fix) | 🟡 Medium | 10min | ⚠️ Partial | Always visible status text |

**Phase A Total**: 70 minutes

#### **Phase B: Technical Components (Day 2 - 1.5 hours)**
**Objective**: Complete parameter and technical component i18n

| Component Group | Count | Effort Each | Total | Status |
|----------------|-------|-------------|-------|--------|
| Parameter components | 4 | 15min | 60min | ⚠️ Partial |
| Technical placeholders | - | - | 20min | ❌ Missing |

**Phase B Total**: 80 minutes

#### **Phase C: Quality & Validation (Day 3 - 1 hour)**
**Objective**: Testing, validation, and documentation

| Task | Effort | Description |
|------|--------|-------------|
| Language switching tests | 20min | Verify all new keys work |
| Translation quality review | 20min | Japanese translation accuracy |
| Documentation update | 20min | Update progress tracker |

**Phase C Total**: 60 minutes

---

## 🔧 Technical Implementation Details

### **Translation Keys to Add**

#### **Immediate Keys (Phase A)**
```typescript
// For new_project_dialog.vue
project: {
  newProject: {
    title: "Create New Project",        // "新規プロジェクト作成"
    placeholder: "Enter project title", // "プロジェクトタイトルを入力"
    // Note: ui.actions.cancel and ui.status.creating already exist
  }
}

// For text_editor.vue  
ui: {
  common: {
    selectSpeaker: "Select a speaker",  // "スピーカーを選択"
    examplePrompt: "e.g. What is AI?",  // "例：AIとは何ですか？"
  }
}

// For header.vue status text
// Note: ui.status.generating already exists, just needs implementation

// For chat.vue
ui: {
  examples: {
    chatMessage: "ex) Thank you very much! Please proceed with the creation.",
    // "例）ありがとうございます！作成を進めてください。"
  }
}
```

#### **Technical Keys (Phase B)**
```typescript
// Parameter component placeholders
parameters: {
  image: {
    autoPlaceholder: "Auto",                    // "自動"
    stylePlaceholder: "e.g. vivid, natural",   // "例：鮮やか、自然"
    qualityPlaceholder: "e.g. low, auto",      // "例：低、自動"
  },
  caption: {
    nonePlaceholder: "None",                    // "なし"
  },
  textSlide: {
    cssPlaceholder: "e.g. font-size: 24px;",   // "例：font-size: 24px;"
  }
}

ui: {
  common: {
    imageOrMovie: "Image or Movie",             // "画像または動画"
    remoteMedia: "Remote Media",                // "リモートメディア"
  }
}
```

### **Component Implementation Pattern**

#### **Standard Implementation (new_project_dialog.vue)**
```vue
<script setup lang="ts">
import { useI18n } from 'vue-i18n'
// ... existing imports

const { t } = useI18n()
// ... existing props and emits
</script>

<template>
  <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50" @click="handleBackdropClick">
    <div class="w-96 max-w-full rounded-lg bg-white p-6" @click.stop>
      <!-- ❌ Before: hardcoded -->
      <!-- <h2 class="mb-4 text-xl font-semibold">Create New Project</h2> -->
      
      <!-- ✅ After: i18n -->
      <h2 class="mb-4 text-xl font-semibold">{{ t('project.newProject.title') }}</h2>
      
      <Input
        :model-value="props.modelValue"
        @update:model-value="(value) => emit('update:modelValue', String(value))"
        type="text"
        :placeholder="t('project.newProject.placeholder')"
        auto-focus
      />
      <div class="mt-4 flex justify-end space-x-3">
        <Button @click="handleCancel" variant="ghost" :disabled="props.creating">
          {{ t('ui.actions.cancel') }}
        </Button>
        <Button @click="handleCreate" :disabled="props.creating">
          {{ props.creating ? t('ui.status.creating') : t('ui.actions.create') }}
        </Button>
      </div>
    </div>
  </div>
</template>
```

#### **Placeholder Fix Pattern (text_editor.vue)**
```vue
<template>
  <div>
    <!-- Fix hardcoded placeholder -->
    <Select :model-value="beat?.speaker" @update:model-value="(value) => update(index, 'speaker', String(value))">
      <SelectTrigger class="h-8">
        <!-- ❌ Before: hardcoded -->
        <!-- <SelectValue placeholder="Select a speaker" /> -->
        
        <!-- ✅ After: i18n -->
        <SelectValue :placeholder="t('ui.common.selectSpeaker')" />
      </SelectTrigger>
      <!-- ... -->
    </Select>
    
    <!-- Fix input placeholder -->
    <Input
      :model-value="beat.text"
      @update:model-value="(value) => update(index, 'text', String(value))"
      @blur="saveMulmo"
      :placeholder="t('ui.common.examplePrompt')"
      class="h-8"
    />
  </div>
</template>
```

---

## ⏰ Detailed Timeline

### **Day-by-Day Execution Plan**

#### **Day 1 (August 6, 2025) - Emergency Response**
```
Phase A: Critical Component Implementation
├── 09:00-09:30: Translation key additions (Phase A keys)
├── 09:30-10:00: new_project_dialog.vue implementation  
├── 10:00-10:20: text_editor.vue placeholder fixes
├── 10:20-10:30: header.vue status text fix
├── 10:30-10:40: chat.vue example message fix
└── 10:40-11:00: Phase A testing (language switching)

Total: 2 hours
```

#### **Day 2 (August 7, 2025) - Technical Components**  
```
Phase B: Parameter Component Implementation
├── 09:00-09:20: Translation key additions (Phase B keys)
├── 09:20-09:35: image_params.vue placeholders
├── 09:35-09:50: caption_params.vue CSS examples  
├── 09:50-10:05: text_slide_params.vue technical examples
├── 10:05-10:20: Remaining parameter fixes
└── 10:20-10:50: Phase B testing

Total: 1 hour 50 minutes
```

#### **Day 3 (August 8, 2025) - Quality & Validation**
```
Phase C: Quality Assurance
├── 09:00-09:20: Complete language switching tests
├── 09:20-09:40: Japanese translation quality review
├── 09:40-10:00: Progress tracker updates
└── 10:00-10:10: Final validation checklist

Total: 1 hour 10 minutes
```

### **Total Project Duration**: 3 days, ~5 hours of focused work

---

## 🎨 Quality Assurance Plan

### **Translation Quality Standards**

#### **Japanese Translation Guidelines**
1. **Natural Japanese**: No machine translation artifacts
2. **UI Context Appropriate**: Short, clear UI text
3. **Technical Terms**: Consistent with existing translations
4. **Placeholder Examples**: Culturally relevant examples

#### **Example Japanese Translations**
```typescript
// High-quality Japanese translations
project: {
  newProject: {
    title: "新規プロジェクト作成",           // Natural, clear
    placeholder: "プロジェクトタイトルを入力",  // Standard UI pattern
  }
}

ui: {
  common: {
    selectSpeaker: "スピーカーを選択",        // Standard selection UI
    examplePrompt: "例：AIとは何ですか？",     // Culturally appropriate example
  }
}
```

### **Testing Strategy**

#### **Automated Testing Checklist**
- [ ] All new translation keys exist in both en.ts and ja.ts
- [ ] No hardcoded strings remain in target components  
- [ ] Language switching works without errors
- [ ] No console errors during i18n operations
- [ ] Placeholder substitution works correctly

#### **Manual Testing Checklist**
- [ ] **Visual Layout**: Text fits properly in both languages
- [ ] **User Flow**: Project creation flow works in both languages
- [ ] **Interactive Elements**: All buttons, placeholders display correctly
- [ ] **Context Appropriateness**: Translations make sense in UI context

---

## 📊 Success Metrics & Validation

### **Target Success Criteria**

#### **Coverage Metrics**
- **Component Coverage**: 100% (from current 62%)
- **Critical Issue Resolution**: 0 HIGH priority issues remaining  
- **Translation Completeness**: en.ts ↔ ja.ts 100% parity
- **Hardcoded Strings**: 0 user-facing hardcoded strings

#### **Quality Gates**
- [ ] **Zero Regression**: Existing i18n functionality unaffected
- [ ] **Performance**: No significant bundle size increase (< 5%)
- [ ] **User Experience**: Smooth language switching
- [ ] **Developer Experience**: Clear patterns for future i18n work

### **Risk Assessment & Mitigation**

#### **High Risk Items**
1. **New Component Integration**: NEW components may have complex i18n requirements
   - **Mitigation**: Test each component individually before integration

2. **Translation Quality**: Japanese translations need native-level quality
   - **Mitigation**: Use established patterns from existing translations

3. **Layout Breakage**: Different text lengths may break layouts
   - **Mitigation**: Test both languages for layout integrity

#### **Low Risk Items**
- Key addition to existing i18n structure (already proven)
- Component modification patterns (established workflow)
- Testing infrastructure (Playwright already available)

---

## 🔄 Post-Implementation Plan

### **Immediate Follow-up (Day 4)**
1. **Progress Tracker Update**: Mark Phase 2 complete with metrics
2. **Documentation**: Update component-by-component status  
3. **Git Commit**: Atomic commits for each phase
4. **User Validation**: Present completed work for approval

### **Long-term Maintenance**  
1. **Pattern Documentation**: Establish i18n patterns for future development
2. **Automated Testing**: Consider adding i18n coverage tests
3. **Translation Management**: Process for updating translations
4. **Developer Guidelines**: Document i18n best practices

---

## 📋 Implementation Readiness Checklist

### **Prerequisites**  
- [x] **Audit Complete**: Comprehensive component analysis done
- [x] **Plan Approved**: This implementation plan reviewed
- [ ] **Environment Ready**: Development environment prepared
- [ ] **Git Backup**: Current progress committed

### **Implementation Tools**
- [x] **Translation Files**: en.ts, ja.ts, common.ts structure confirmed  
- [x] **Component List**: All 28 target components identified
- [x] **Key Mappings**: Translation key structure defined
- [ ] **Testing Setup**: Language switching test environment ready

---

## 📈 Expected Outcomes

### **Immediate Impact (End of Week)**
- **100% i18n Coverage**: All components fully internationalized
- **Zero Critical Issues**: All HIGH and MEDIUM priority gaps resolved
- **User Experience**: Seamless bilingual application experience
- **Developer Confidence**: Clear patterns for future i18n work

### **Long-term Benefits**  
- **Maintenance Efficiency**: Structured approach reduces future i18n overhead
- **Scalability**: Easy addition of new languages or components
- **Quality Consistency**: Established translation and testing patterns
- **User Adoption**: Professional bilingual application ready for broader use

---

## 🚀 Implementation Commands

### **Phase A Commands**
```bash
# Add translation keys
/i18n-add-keys "project.newProject.title,ui.common.selectSpeaker" 

# Implement critical components  
/i18n-batch "new_project_dialog.vue,text_editor.vue" both

# Test critical paths
/i18n-test "project-creation,beat-editing"
```

### **Phase B Commands**  
```bash
# Parameter components batch
/i18n-batch "parameters/**/*.vue" both

# Technical component fixes
/i18n-fix-hardcoded "header.vue,chat.vue"
```

### **Phase C Commands**
```bash  
# Complete validation
/i18n-audit all

# Update documentation  
/i18n-progress-update complete
```

---

## ⚠️ Important Notes

### **Context-Specific Considerations**
1. **Main Branch Merge Impact**: This plan specifically addresses components introduced by recent main branch merge
2. **Existing Structure Preservation**: Leverage well-established i18n architecture, no refactoring needed
3. **Priority-First Approach**: Focus on user-critical components before technical components
4. **Incremental Validation**: Test each phase before proceeding to next

### **Success Dependencies**
- Quick turnaround on critical components (within 24 hours)
- Maintaining existing i18n quality standards
- Effective testing of language switching functionality
- Proper documentation of new patterns established

---

**📌 Plan Status**: Ready for Human Checkpoint 2 approval  
**🎯 Success Criteria**: 100% i18n coverage with zero critical issues  
**⏱️ Estimated Duration**: 3 days, ~5 hours focused implementation work  
**🔄 Next Step**: Human approval to proceed to Phase 3 (Implementation)